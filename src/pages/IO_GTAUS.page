<apex:page standardController="Opportunity" extensions="AdSalesIOExtension" showHeader="false" applyHtmlTag="false" applyBodyTag="false" renderas="pdf">
<head>
    <apex:styleSheet value="{!URLFOR($Resource.pdfStyles, 'css/IO.css')}"/>
    <apex:styleSheet value="{!URLFOR($Resource.pdfStyles, 'css/IO_GTAUS.css')}"/>
    <style type="text/css">
        body{
            color: #36263b;
        }
        .blackBg{
            background-color: #36263b !important;
        }
        .lightgreyBg{
            background-color: #eae9eb !important;
        }
        .darkgreyBg{
            background-color: #afafaf !important;
        }
        .lightBg{
            background-color: #f4f4f4 !important;
        }
        .colWhite {
            color: #fff !important;
        }
        .colOrange {
            color: #3baa33;
        }
        .colGreenHeader {
            font-size: 16px; 
            color: #3baa33;
            font-weight: 600 !important;
        }
        .colDarkgrey{
            color: #353535;
        }
        b,
        .bold{
            font-weight: 600 !important;
            font-family: sans-serif;
        }
        .rightWhiteBorder{
            border-right: 3px solid #fff;
        }
        .spacing{
            padding-left: 5px;
            padding-right: 5px;
        }
        .bottomWhiteBorder{
            border-bottom: 1px solid #fff;
        }
    </style>
</head>

<body>
    <table border="0" cellspacing="0" cellpadding="0" width="100%" id="table1">
        <tr>
            <td>
                <table border="0" cellspacing="16px" cellpadding="0" width="50%" id="table1">
                    <tr>
                        <td class="left"><b class="colGreenHeader">Date: </b>
                            <span>
                                <apex:outputText value="{0,date,dd'/'MM'/'yyyy}">
                                    <apex:param value="{!NOW()}" /> 
                                </apex:outputText>
                            </span>
                        </td>
                    </tr>
                    <tr></tr>    
                    <tr>          
                        <td class="left"><b class="colGreenHeader">Advertiser Agreement</b></td>
                    </tr>
                </table>    
            </td>
            <td class="right">
                <img src="{!URLFOR($Resource.pdfStyles,'img/Logo_GTAUS.png')}" title="logo" width="240px"/>
            </td>
        </tr>
    </table>
    <!-- New template -->
    <!-- Contact -->
    <table border="0" width="100%">
        <tr>
            <td class="blackBg rightWhiteBorder spacing">
                <b class="bold colWhite">Customer Contact</b>
            </td>
            <td class="darkgreyBg spacing">
                <b class="bold colWhite">Gumtree Contact</b>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder">
                <b class="colOrange">Advertiser: </b><span>{!Opportunity.Account.Name}</span>
            </td>
            <td class="lightBg spacing">
                <b class="bold">Order: </b><span>{!Opportunity.IOnumber__c}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder">
                <b class="colOrange">Campaign: </b><span>{!Opportunity.Name}</span>
            </td>
            <td class="lightBg spacing">
                <b class="bold">Gumtree Sales Contact: </b><span>{!Opportunity.Owner.FirstName} {!Opportunity.Owner.LastName}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder">
                <b class="colOrange">Planning Agency: </b><span>{!Opportunity.Agency__r.Name}</span>
            </td>
            <td class="lightBg spacing">
                <b class="bold">Email: </b><span>{!Opportunity.Owner.Email}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder">
                <b class="colOrange">Bill To: </b><span>{!Opportunity.Billing_Account__r.Name}</span>
            </td>
            <td class="lightBg spacing">
                <b class="bold">Phone Number: </b><span>{!Opportunity.Owner.Phone}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder" colspan="2">
                <b class="colOrange">Primary Contact: </b><span>{!Opportunity.Primary_Contact__r.FirstName} {!Opportunity.Primary_Contact__r.LastName}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder" colspan="2">
                <b class="colOrange">Phone Number: </b><span>{!Opportunity.Primary_Contact__r.Phone}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder" colspan="2">
                <b class="colOrange">Fax: </b><span>{!Opportunity.Primary_Contact__r.Fax}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing bottomWhiteBorder" colspan="2">
                <b class="colOrange">Email: </b><span>{!Opportunity.Primary_Contact__r.Email}</span>
            </td>
        </tr>
        <tr>
            <td class="lightgreyBg rightWhiteBorder spacing" colspan="2">
                <b class="colOrange">Address: </b><span>{!Opportunity.Primary_Contact__r.MailingStreet}, {!Opportunity.Primary_Contact__r.MailingCity} {!Opportunity.Primary_Contact__r.MailingPostalcode}, {!Opportunity.Primary_Contact__r.MailingCountry}</span>
            </td>
        </tr>
    </table>
    <!-- End New template -->

    <br/>
    <br/>

    <!-- Line items -->
    <table  class="lineitems" id="table_lineitems">
        <tr>
            <th width="35%" class="blackBg colWhite"><b>Description</b></th>
            <th width="10%" class="blackBg colWhite"><b>Start</b></th>
            <th width="10%" class="blackBg colWhite"><b>End</b></th>

            <th width="10%" class="blackBg colWhite"><b>Billing Category</b></th>
            <th width="10%" class="right blackBg colWhite"><b>Quantity</b></th>
            <th width="10%" class="blackBg colWhite"><b>Rate</b></th>
            <th width="15%" class="right blackBg colWhite"><b>Total</b></th>
        </tr>

        <apex:repeat var="oli" value="{!sortrecord}" >
        <tr class="thinbottomborder">
            <td class="thinbottomborder">{!oli.DefaultLineDescription__c}</td>

            <td class="thinbottomborder"><apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!oli.from_Date__c}"/></apex:outputText></td>
            <td class="thinbottomborder"><apex:outputText value="{0,date,dd'/'MM'/'yyyy}"><apex:param value="{!oli.until_Date__c}"/></apex:outputText></td>

            <td class="thinbottomborder">{!oli.Billing_Category__c}</td>
            <td class="thinbottomborder right"><apex:outputText value="{0, number, ###,###,###,###}"><apex:param value="{!oli.Quantity}"/></apex:outputText></td>

            <td class="thinbottomborder right"><apex:OutputField value="{!oli.SalesPriceBeforeID__c}"/></td>
            <td class="thinbottomborder right"><apex:OutputField value="{!oli.TotalAmountBeforeID__c}"/></td>

        </tr>
        </apex:repeat>

        <tr>
            <td colspan="4"></td>
            <td colspan="2" class="right thinbottomborder"><b>Totals</b></td>
            <td class="right thinbottomborder"><apex:outputField value="{!Opportunity.TotalAmountBeforeID__c}"/></td>
        </tr>
        <apex:outputPanel rendered="{!Opportunity.IndirectDiscount__c>0}" layout="none">
        <tr>
            <td colspan="4"></td>
            <td colspan="2" class="right thinbottomborder"><b>Agency Discount ({!Opportunity.IndirectDiscount__c}%)</b></td>
            <td class="right thinbottomborder"><apex:outputField value="{!Opportunity.IndirectDiscountAmount__c}"/></td>
        </tr>
        <tr>
            <td colspan="4"></td>
            <td colspan="2" class="right thinbottomborder"><b>Net Contract Amount</b></td>
            <td class="right thinbottomborder"><apex:outputField value="{!Opportunity.TotalAmountNet__c}"/></td>
        </tr>
        </apex:outputPanel>
        <apex:outputPanel rendered="{!Opportunity.Billing_Account__r.Apply_VAT__c}" layout="none">
        <tr>
            <td colspan="4"></td>
            <td colspan="2" class="right thinbottomborder"><b>GST ({!Opportunity.Billing_Account__r.VAT__c}%)</b></td>
            <td class="right thinbottomborder"><apex:outputField value="{!Opportunity.VatAmount__c}"/></td>
        </tr>
        <tr>
            <td colspan="4"></td>
            <td colspan="2" class="right thinbottomborder"><b>Total Due (AUD)</b></td>
            <td class="right thinbottomborder"><apex:outputText value="AUD {0, number, ###,###,##0.00}"><apex:param value="{!Opportunity.TotalAmountNet__c+Opportunity.VatAmount__c}"/></apex:outputText></td>
        </tr>
        </apex:outputPanel>

    </table><!-- End Line items -->
    <br/>
    <br/>
    <!-- Notes -->
    <table  class="lineitems" id="table_notes">
        <tr>
            <th class="blackBg colWhite" width="35%"><b>Notes</b></th>
        </tr>

        <tr >
            <td >{!Opportunity.Description}</td>
        </tr>
    </table>
    <!-- End Notes -->

    <br/>
    <br/>

    <!-- Contract Acknowledgment -->
    <table class="lineitems" id="table_ContractAck">
        <tr>
            <th class="blackBg colWhite" width="100%"><b>Contract Acknowledgment</b></th>
        </tr>
        <tr>
            <td width="100%"><i>This Advertising Insertion Order is between eBay UK Limited (Australia Branch) (“Company”) and Advertiser.  The body of this Advertising Insertion Order, together with the attached Standard Terms and Conditions for Advertising with gumtree.com.au (collectively, this “Agreement”) set forth the entire agreement and understanding between the parties as to the subject matter hereof and supersedes all prior discussions, agreements and understandings of any kind, and every nature between them.  This Agreement shall be binding upon both parties upon Advertiser’s signature below, which demonstrates acceptance of the terms and conditions of the Agreement and the commercial offer given by Company.  Company consents to electronic transmission (e-mail, fax or otherwise) as acceptable means to constitute a written acceptance of an authorized person for Advertiser.
Advertiser has read, understands and agrees to this Agreement:</i><br/></td>
        </tr>

        <tr>
            <td>
            Advertiser has read, understands and agrees to this Agreement:<br/><br/>
            </td>
        </tr>
    </table>
    <!-- End Contract Acknowledgment -->
    <br/>
    <br/>
    <table width="100%" id="table5">

        <tr>
            <td width="15%">Advertiser:</td>
            <td width="35%"><apex:outputField value="{!Opportunity.Account.Name}"/></td>
            <td width="15%"></td>
            <td width="35%"></td>
        </tr>
        <tr>
            <td>Total</td>
            <td><apex:outputText value="AUD {0, number, ###,###,##0.00}"><apex:param value="{!Opportunity.TotalAmountNet__c+Opportunity.VatAmount__c}"/></apex:outputText></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>Print Name:</td>
            <td>{{_es_signer_fullname}}</td>
        </tr>
        <tr>
            <td>Print Title:</td>
            <td class="echosign_container">{{*_es_signer_title}}</td>
            <td/>
            <td/>
        </tr>
        <tr>
            <td>Signature:</td>
            <td class="echosign_container">{{_es_signer_signature}}</td>
            <td/>
            <td/>
        </tr>
        <tr>
            <td>Date:</td>
            <td class="echosign_container" >{{_es_signer_date}}</td>
            <td/>
            <td/>
        </tr>

    </table>

</body>
</apex:page>